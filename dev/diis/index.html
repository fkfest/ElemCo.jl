<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DIIS solver · ElemCo.jl documentation</title><meta name="title" content="DIIS solver · ElemCo.jl documentation"/><meta property="og:title" content="DIIS solver · ElemCo.jl documentation"/><meta property="twitter:title" content="DIIS solver · ElemCo.jl documentation"/><meta name="description" content="Documentation for ElemCo.jl documentation."/><meta property="og:description" content="Documentation for ElemCo.jl documentation."/><meta property="twitter:description" content="Documentation for ElemCo.jl documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ElemCo.jl documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ElemCo.jl documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../elemco/">Running calculations</a></li><li><a class="tocitem" href="../options/">Options</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../basisset/">Basis set</a></li><li><a class="tocitem" href="../bohf/">Bi-orthogonal Hartree-Fock</a></li><li><a class="tocitem" href="../cc/">Coupled-cluster methods</a></li><li><a class="tocitem" href="../ccdriver/">Driver for conventional coupled-cluster methods</a></li><li><a class="tocitem" href="../cctools/">Coupled-cluster tools</a></li><li><a class="tocitem" href="../constants/">Constants and transformations between units</a></li><li><a class="tocitem" href="../decomptools/">Tensor-decomposition tools</a></li><li><a class="tocitem" href="../dfcc/">Density-fitted Coupled Cluster methods</a></li><li><a class="tocitem" href="../dfdump/">Generation of integrals using density fitting</a></li><li><a class="tocitem" href="../dfhf/">Density-fitted Hartree-Fock</a></li><li><a class="tocitem" href="../dfmcscf/">MCSCF program</a></li><li><a class="tocitem" href="../dftools/">Density-fitting tools</a></li><li class="is-active"><a class="tocitem" href>DIIS solver</a><ul class="internal"><li><a class="tocitem" href="#Main-structure"><span>Main structure</span></a></li><li><a class="tocitem" href="#Exported-functions"><span>Exported functions</span></a></li><li><a class="tocitem" href="#Internal-functions"><span>Internal functions</span></a></li></ul></li><li><a class="tocitem" href="../dmrg/">DMRG</a></li><li><a class="tocitem" href="../dump/">FCIDump files</a></li><li><a class="tocitem" href="../dumptools/">Dump tools</a></li><li><a class="tocitem" href="../elements/">Elements</a></li><li><a class="tocitem" href="../ecinfos/">ElemCo.jl global information</a></li><li><a class="tocitem" href="../ecmethod/">ElemCo.jl methods</a></li><li><a class="tocitem" href="../fockfactory/">Fock builders</a></li><li><a class="tocitem" href="../integrals/">Integrals</a></li><li><a class="tocitem" href="../mio/">I/O routines</a></li><li><a class="tocitem" href="../mnpy/">Memory-maping of NPY files</a></li><li><a class="tocitem" href="../msystem/">Molecular system</a></li><li><a class="tocitem" href="../orbtools/">Orbital tools</a></li><li><a class="tocitem" href="../qmtensors/">QMTensors</a></li><li><a class="tocitem" href="../tensortools/">Tensor tools</a></li><li><a class="tocitem" href="../descdict/">Ordered descriptive dictionary</a></li><li><a class="tocitem" href="../utils/">Utils</a></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li><li><a class="tocitem" href="../molpro/">Molpro Interface</a></li><li><a class="tocitem" href="../molden/">Molden Interface</a></li></ul></li><li><a class="tocitem" href="../release-notes/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internals</a></li><li class="is-active"><a href>DIIS solver</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DIIS solver</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fkfest/ElemCo.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fkfest/ElemCo.jl/blob/main/docs/src/diis.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="DIIS-solver"><a class="docs-heading-anchor" href="#DIIS-solver">DIIS solver</a><a id="DIIS-solver-1"></a><a class="docs-heading-anchor-permalink" href="#DIIS-solver" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS" href="#ElemCo.DIIS"><code>ElemCo.DIIS</code></a> — <span class="docstring-category">Module</span></header><section><div><p>DIIS module for iterative solvers</p><p>This module provides the DIIS (Direct Inversion in the Iterative Subspace) method for iterative solvers.</p><p>The DIIS method is used to accelerate the convergence of iterative solvers by combining    previous solutions to the problem to minimize the residual.   The vectors and residuals are stored in files as <code>Vector{Vector{Float64}}</code>.</p><p><strong>Usage</strong></p><pre><code class="language-julia hljs">diis = Diis(EC)
for it = 1:maxit
  # compute Vec = [Vec1,Vec2,...] and Res = [Res1,Res2,...]
  # ...
  perform!(diis, Vec, Res)
  # ...
end</code></pre><p>One can also provide a tuple of custom dot-product functions for the residuals components as <code>customdots</code> argument in <a href="#ElemCo.DIIS.perform!"><code>perform!</code></a> function.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L1-L23">source</a></section></article><h2 id="Main-structure"><a class="docs-heading-anchor" href="#Main-structure">Main structure</a><a id="Main-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Main-structure" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.Diis" href="#ElemCo.DIIS.Diis"><code>ElemCo.DIIS.Diis</code></a> — <span class="docstring-category">Type</span></header><section><div><p>DIIS object</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L31-L33">source</a></section></article><h2 id="Exported-functions"><a class="docs-heading-anchor" href="#Exported-functions">Exported functions</a><a id="Exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Exported-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.perform!" href="#ElemCo.DIIS.perform!"><code>ElemCo.DIIS.perform!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">perform!(diis::Diis, Amps, Res, customdots=())</code></pre><p>Perform DIIS.</p><p><code>Amps</code> is an array of vectors and <code>Res</code> is an array of residuals.   The vectors <code>Amps</code> will be replaced by the DIIS optimized vectors.   <code>customdots</code> is a tuple of functions for each residual component to calculate   the dot-product. The functions should have the signature <code>f(ten1::Array{T,N}, ten2::Array{T,N})</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L225-L234">source</a></section></article><h2 id="Internal-functions"><a class="docs-heading-anchor" href="#Internal-functions">Internal functions</a><a id="Internal-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.combine-Tuple{ElemCo.DIIS.Diis, Any, Any}" href="#ElemCo.DIIS.combine-Tuple{ElemCo.DIIS.Diis, Any, Any}"><code>ElemCo.DIIS.combine</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">combine(diis::Diis, vecfiles, coeffs)</code></pre><p>Combine vectors from files with coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L119-L123">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.custom_dot-Tuple{ElemCo.DIIS.Diis, Any, Any, Any}" href="#ElemCo.DIIS.custom_dot-Tuple{ElemCo.DIIS.Diis, Any, Any, Any}"><code>ElemCo.DIIS.custom_dot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">custom_dot(diis::Diis, customdots, tens, vecs)</code></pre><p>Compute weighted (with diis.weights) dot product of vectors   using custom dot-product functions <code>customdots::Tuple</code>.   <code>vecs</code> are reshaped to the shape of tensors <code>tens</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L156-L162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.loadamps-Tuple{ElemCo.DIIS.Diis, Any}" href="#ElemCo.DIIS.loadamps-Tuple{ElemCo.DIIS.Diis, Any}"><code>ElemCo.DIIS.loadamps</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">loadamps(diis::Diis, ipos)</code></pre><p>Load vectors from file at position <code>ipos</code> as <code>Vector{Vector{Float64}}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L101-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.loadres-Tuple{ElemCo.DIIS.Diis, Any}" href="#ElemCo.DIIS.loadres-Tuple{ElemCo.DIIS.Diis, Any}"><code>ElemCo.DIIS.loadres</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">loadres(diis::Diis, ipos)</code></pre><p>Load residuals from file at position <code>ipos</code> as <code>Vector{Vector{Float64}}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.loadvecs-Tuple{Any}" href="#ElemCo.DIIS.loadvecs-Tuple{Any}"><code>ElemCo.DIIS.loadvecs</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">loadvecs(file)</code></pre><p>Load vectors from file as <code>Vector{Vector{Float64}}</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.saveamps-Tuple{ElemCo.DIIS.Diis, Any, Any}" href="#ElemCo.DIIS.saveamps-Tuple{ElemCo.DIIS.Diis, Any, Any}"><code>ElemCo.DIIS.saveamps</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saveamps(diis::Diis, vecs, ipos)</code></pre><p>Save vectors to file (replacing previous vectors at position <code>ipos</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L74-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.saveres-Tuple{ElemCo.DIIS.Diis, Any, Any}" href="#ElemCo.DIIS.saveres-Tuple{ElemCo.DIIS.Diis, Any, Any}"><code>ElemCo.DIIS.saveres</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">saveres(diis::Diis, vecs, ipos)</code></pre><p>Save residuals to file (replacing previous residuals at position <code>ipos</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.update_Bmat" href="#ElemCo.DIIS.update_Bmat"><code>ElemCo.DIIS.update_Bmat</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">update_Bmat(diis::Diis, nDim, Res, ithis, customdots=())</code></pre><p>Update B matrix with new residual (at the position <code>ithis</code>).</p><p>B matrix is defined as:</p><p class="math-container">\[{\bf B} = \begin{pmatrix}
\langle {\bf R}_1, {\bf R}_1 \rangle &amp; \langle {\bf R}_1, {\bf R}_2 \rangle &amp; \cdots &amp; \langle {\bf R}_1, {\bf R}_{\rm nDim} \rangle &amp; -1 \\
\langle {\bf R}_2, {\bf R}_1 \rangle &amp; \langle {\bf R}_2, {\bf R}_2 \rangle &amp; \cdots &amp; \langle {\bf R}_2, {\bf R}_{\rm nDim} \rangle &amp; -1 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
\langle {\bf R}_{\rm nDim}, {\bf R}_1 \rangle &amp; \langle {\bf R}_{\rm nDim}, {\bf R}_2 \rangle &amp; \cdots &amp; \langle {\bf R}_{\rm nDim}, {\bf R}_{\rm nDim} \rangle &amp; -1 \\
-1 &amp; -1 &amp; \cdots &amp; -1 &amp; 0
\end{pmatrix}\]</p><p>Returns the dot product of the new residual with itself, <span>$\langle {\bf R}_{\rm ithis}, {\bf R}_{\rm ithis} \rangle$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L182-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.DIIS.weighted_dot-Tuple{ElemCo.DIIS.Diis, Any, Any}" href="#ElemCo.DIIS.weighted_dot-Tuple{ElemCo.DIIS.Diis, Any, Any}"><code>ElemCo.DIIS.weighted_dot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">weighted_dot(diis::Diis, vecs1, vecs2)</code></pre><p>Compute weighted (with diis.weights) dot product of vectors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/21e35669010714195bc44723fb04d90744464e84/src/solvers/diis.jl#L139-L143">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../dftools/">« Density-fitting tools</a><a class="docs-footer-nextpage" href="../dmrg/">DMRG »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Friday 12 July 2024 07:22">Friday 12 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
