<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Coupled-cluster methods · ElemCo.jl documentation</title><meta name="title" content="Coupled-cluster methods · ElemCo.jl documentation"/><meta property="og:title" content="Coupled-cluster methods · ElemCo.jl documentation"/><meta property="twitter:title" content="Coupled-cluster methods · ElemCo.jl documentation"/><meta name="description" content="Documentation for ElemCo.jl documentation."/><meta property="og:description" content="Documentation for ElemCo.jl documentation."/><meta property="twitter:description" content="Documentation for ElemCo.jl documentation."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ElemCo.jl documentation logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ElemCo.jl documentation</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../elemco/">Running calculations</a></li><li><a class="tocitem" href="../options/">Options</a></li></ul></li><li><span class="tocitem">Internals</span><ul><li><a class="tocitem" href="../basisset/">Basis set</a></li><li><a class="tocitem" href="../bohf/">Bi-orthogonal Hartree-Fock</a></li><li class="is-active"><a class="tocitem" href>Coupled-cluster methods</a><ul class="internal"><li><a class="tocitem" href="#Exported-functions"><span>Exported functions</span></a></li><li><a class="tocitem" href="#Internal-functions"><span>Internal functions</span></a></li></ul></li><li><a class="tocitem" href="../ccdriver/">Driver for conventional coupled-cluster methods</a></li><li><a class="tocitem" href="../cctools/">Coupled-cluster tools</a></li><li><a class="tocitem" href="../constants/">Constants and transformations between units</a></li><li><a class="tocitem" href="../decomptools/">Tensor-decomposition tools</a></li><li><a class="tocitem" href="../dfcc/">Density-fitted Coupled Cluster methods</a></li><li><a class="tocitem" href="../dfdump/">Generation of integrals using density fitting</a></li><li><a class="tocitem" href="../dfhf/">Density-fitted Hartree-Fock</a></li><li><a class="tocitem" href="../dfmcscf/">MCSCF program</a></li><li><a class="tocitem" href="../dftools/">Density-fitting tools</a></li><li><a class="tocitem" href="../diis/">DIIS solver</a></li><li><a class="tocitem" href="../dmrg/">DMRG</a></li><li><a class="tocitem" href="../dump/">FCIDump files</a></li><li><a class="tocitem" href="../dumptools/">Dump tools</a></li><li><a class="tocitem" href="../elements/">Elements</a></li><li><a class="tocitem" href="../ecinfos/">ElemCo.jl global information</a></li><li><a class="tocitem" href="../ecmethod/">ElemCo.jl methods</a></li><li><a class="tocitem" href="../fockfactory/">Fock builders</a></li><li><a class="tocitem" href="../integrals/">Integrals</a></li><li><a class="tocitem" href="../mio/">I/O routines</a></li><li><a class="tocitem" href="../mnpy/">Memory-maping of NPY files</a></li><li><a class="tocitem" href="../msystem/">Molecular system</a></li><li><a class="tocitem" href="../orbtools/">Orbital tools</a></li><li><a class="tocitem" href="../qmtensors/">QMTensors</a></li><li><a class="tocitem" href="../tensortools/">Tensor tools</a></li><li><a class="tocitem" href="../descdict/">Ordered descriptive dictionary</a></li><li><a class="tocitem" href="../utils/">Utils</a></li><li><a class="tocitem" href="../interfaces/">Interfaces</a></li><li><a class="tocitem" href="../molpro/">Molpro Interface</a></li><li><a class="tocitem" href="../molden/">Molden Interface</a></li></ul></li><li><a class="tocitem" href="../release-notes/">Release notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Internals</a></li><li class="is-active"><a href>Coupled-cluster methods</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Coupled-cluster methods</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/fkfest/ElemCo.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/fkfest/ElemCo.jl/blob/main/docs/src/cc.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Coupled-cluster-methods"><a class="docs-heading-anchor" href="#Coupled-cluster-methods">Coupled-cluster methods</a><a id="Coupled-cluster-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Coupled-cluster-methods" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster" href="#ElemCo.CoupledCluster"><code>ElemCo.CoupledCluster</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Coupled-cluster methods </p><p>The following coupled-cluster methods are implemented in <code>ElemCo.jl</code>:</p><ul><li><code>ccsd</code> - closed-shell implementation, for open-shell systems defaults to <code>uccsd</code>, </li><li><code>uccsd</code> - unrestricted implementation,</li><li><code>rccsd</code> - restricted implementation (for high-spin RHF reference only),</li><li><code>ccsd(t)</code> - closed-shell implementation,</li><li><code>dcsd</code> - closed-shell implementation, for open-shell systems defaults to <code>udcsd</code>,</li><li><code>udcsd</code> - unrestricted implementation,</li><li><code>rdcsd</code> - restricted implementation (for high-spin RHF reference only),</li><li><code>λccsd</code> - calculation of Lagrange multipliers, closed-shell implementation,</li><li><code>λccsd(t)</code> - closed-shell implementation,</li><li><code>λdcsd</code> - calculation of Lagrange multipliers, closed-shell implementation.</li></ul><p>The most efficient version of closed-shell CCSD/DCSD in <code>ElemCo.jl</code> combines the dressed factorization from <sup class="footnote-reference"><a id="citeref-Kats2013" href="#footnote-Kats2013">[Kats2013]</a></sup> with  the <code>cckext</code> type of factorization from <sup class="footnote-reference"><a id="citeref-Hampel1992" href="#footnote-Hampel1992">[Hampel1992]</a></sup> and is given by</p><p class="math-container">\[\begin{align*}
\mathcal{L} &amp;= v_{kl}^{cd} \tilde T^{kl}_{cd} + \left(\hat f_k^c + f_k^c\right) T^k_c
+ Λ_{ij}^{ab} \left(\hat v_{kl}^{ij} \red{+ v_{kl}^{cd} T^{ij}_{cd}}\right) T^{kl}_{ab}
+ Λ_{ij}^{ab} R^{ij}_{pq} δ_a^p δ_b^q 
\red{+Λ_{ij}^{ab} v_{kl}^{cd}T^{kj}_{ad}T^{il}_{cb}}\\
&amp;+ Λ_{ij}^{ab} \mathcal{P}(ai;bj)\left\{\left(\hat f_a^c - \red{2\times}\frac{1}{2}v_{kl}^{cd} \tilde T^{kl}_{ad}\right)T^{ij}_{cb}
- \left(\hat f_k^i + \red{2\times}\frac{1}{2}v_{kl}^{cd}\tilde T^{il}_{cd}\right)T^{kj}_{ab} \right.\\
&amp;+ \left(\hat v_{al}^{id}
+ \frac{1}{2} v_{kl}^{cd}\tilde T^{ik}_{ac}\right)\tilde T^{lj}_{db}
- \hat v_{ka}^{ic} T^{kj}_{cb} -\hat v_{kb}^{ic} T^{kj}_{ac}
\red{-v_{kl}^{cd}T^{ki}_{da}\left(T^{lj}_{cb}-T^{lj}_{bc}\right)}\\
&amp;\left.- R^{ij}_{pq} \left(δ_k^p δ_b^q - \frac{1}{2} δ_k^p δ_l^q T^l_b\right) T^k_a \right\}
+Λ_i^a R^{ij}_{pq}\left( 2δ_a^p δ_j^q - δ_j^p δ_a^q \right)
-Λ_i^a T^k_a R^{ij}_{pq}\left( 2δ_k^p δ_j^q - δ_j^p δ_k^q \right)\\
&amp;+Λ_i^a \hat h_a^i + Λ_i^a \hat f_j^b \tilde T^{ij}_{ab} 
- Λ_i^a \hat v_{jk}^{ic} \tilde T^{kj}_{ca},
\end{align*}\]</p><p>where</p><p class="math-container">\[R^{ij}_{pq} = v_{pq}^{rs} \left(\left(T^{ij}_{ab}+T^i_a T^j_b\right)δ_r^a δ_s^b 
+δ_r^i T^j_b δ_s^b + T^i_a δ_r^a δ_s^j + δ_r^i δ_s^j \right). \]</p><p>The DCSD Lagrangian is obtained by removing terms in red. Integrals with hats are dressed integrals, i.e. they are obtained by dressing the integrals with the singles amplitudes, e.g., <span>$\hat v_{kl}^{id} = v_{kl}^{id} + v_{kl}^{cd} T^i_c$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L1-L51">source</a></section></article><p>Lagrange multiplier equations for coupled cluster singles/doubles methods:</p><p class="math-container">\[\begin{aligned}
\frac{\partial\mathcal{L}}{\partial T^m_e}&amp;=
\left(2 v_{qm}^{pe} - v_{qm}^{ep}\right) \hat D_p^q + 2f_m^e 
- 2 Λ_{ij}^{eb} \hat v_{mb}^{ij}
+ 2 K_{mj}^{rs} \delta_r^e \left(\delta_s^j + \delta_s^b T^j_b \right) \\
&amp;+2 D_{mj}^{kl} \hat v_{kl}^{ej}  
- 2 Λ_{ij}^{eb} \left(\hat v_{mb}^{cd} T^{ij}_{cd}\right)
- D_d^e \hat f_m^d + D_m^k \hat f_k^e 
- 2 D_{id}^{el} \hat v_{ml}^{id} 
+ 2 D_{md}^{al} \hat v_{al}^{ed}\\
&amp;+ 2\bar D_{ic}^{ek} \hat v_{km}^{ic} 
- 2\bar D_{mc}^{ak} \hat v_{ka}^{ec} 
- Λ_{i}^{e} \hat f_{m}^{i}
+ Λ_{m}^{a} \hat f_{a}^{e}
- Λ_i^e x_m^i - Λ_m^a x_a^e.
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
\frac{\partial\mathcal{L}}{\partial T^{mn}_{ef}}&amp;=
\tilde v_{mn}^{ef} 
+ Λ_{ij}^{ef} \left(\hat v_{mn}^{ij} \red{+ v_{mn}^{cd} T^{ij}_{cd}}\right) 
\red{+ D_{mn}^{kl} v_{kl}^{ef} } + K_{mn}^{rs} \delta_r^e \delta_s^f\\
&amp;+ \mathcal{P}(em;fn)\left\{ 
Λ_{mn}^{af} \left(\hat f_a^e - \red{2\times}\frac{1}{2} x_a^e\right)
- Λ_{in}^{ef} \left(\hat f_m^i + \red{2\times}\frac{1}{2} x_m^i\right)
\right. \\
&amp;+ \mathcal{T}(mn) \left[\red{2\times}\frac{1}{4} v_{kn}^{ef} D_m^k 
- \red{2\times}\frac{1}{4} v_{mn}^{cf} D_c^e
+ Λ_{in}^{af}\left(\hat v_{am}^{ie} + v_{km}^{ce}\tilde T^{ik}_{ac}\right)\right.\\
&amp;\left.+ \frac{1}{2} \left(
  Λ_m^e \hat f_n^f 
+ Λ_n^a \hat v_{am}^{fe} - Λ_i^f \hat v_{nm}^{ie} \right) \right] 
\\
&amp;\left.- Λ_{in}^{af} \hat v_{ma}^{ie} - Λ_{in}^{eb} \hat v_{mb}^{if}
\red{-D_{nc}^{fl} v_{ml}^{ce} +\bar D_{nd}^{ek}v_{km}^{fd}} \right\},\\
\end{aligned}\]</p><p>with</p><p class="math-container">\[\begin{aligned}
&amp;K_{mn}^{rs} = \hat \Lambda_{mn}^{pq} v_{pq}^{rs} \\
&amp;\hat \Lambda_{mn}^{pq} = Λ_{mn}^{ab}\delta_a^p\delta_b^q 
- Λ_{mn}^{ab} T^i_a  \delta_i^p \delta_b^q
- Λ_{mn}^{ab} \delta_a^p T^j_b \delta_j^q
+ Λ_{mn}^{ab} T^i_a T^j_b \delta_i^p \delta_j^q\\
&amp;x_m^i = \tilde T^{il}_{cd} v_{ml}^{cd} \qquad\qquad
x_a^e = \tilde T^{kl}_{ac} v_{kl}^{ec}\\
&amp;\mathcal{T}(mn) X_{mn}^{ef} = 2X_{mn}^{ef} - X_{nm}^{ef}\\
&amp;D_{ij}^{kl} = \Lambda_{ij}^{cd} T^{kl}_{cd} \\
&amp;D_{ib}^{aj} = \Lambda_{ik}^{ac} \tilde T^{kj}_{cb} \\
&amp;\bar D_{ib}^{aj} = \Lambda_{ik}^{ac} T^{kj}_{cb} + \Lambda_{ik}^{ca} T^{kj}_{bc} \\
\end{aligned}\]</p><h2 id="Exported-functions"><a class="docs-heading-anchor" href="#Exported-functions">Exported functions</a><a id="Exported-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Exported-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_1RDM-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 4}}" href="#ElemCo.CoupledCluster.calc_1RDM-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 4}}"><code>ElemCo.CoupledCluster.calc_1RDM</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_1RDM(EC::ECInfo, U1, U2, T1, T2)</code></pre><p>Calculate the 1RDM for the closed-shell CCSD or DCSD equations.</p><p>Return <code>D1[p,q]</code>=<span>$D_p^q$</span>, the 1RDM without T1 singles terms,  and <code>dD1[p,q]</code>=<span>$\hat D_p^q$</span>, the 1RDM with all T1 terms included.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L785-L792">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_1RDM-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 8}}" href="#ElemCo.CoupledCluster.calc_1RDM-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 8}}"><code>ElemCo.CoupledCluster.calc_1RDM</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_1RDM(EC::ECInfo, U1, U1os, U2, U2ab, T1, T2, T2ab, spin)</code></pre><p>Calculate the <code>spin</code>-1RDM for the unrestricted CCSD or DCSD equations.</p><p><code>U1</code>, <code>U2</code>, <code>T1</code>, <code>T2</code> are the Lagrange multipliers and amplitudes for <code>spin</code>∈{<code>:α</code>,<code>:β</code>}, <code>U1os</code> are the singles Lagrange multipliers for opposite spin, and <code>U2ab</code>, <code>T2ab</code> are the αβ Lagrange multipliers and amplitudes.</p><p>Return <code>D1[p,q]</code>=<span>$D_p^q$</span>, the 1RDM without T1 singles terms,  and <code>dD1[p,q]</code>=<span>$\hat D_p^q$</span>, the 1RDM with all T1 terms included.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L839-L850">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_MP2" href="#ElemCo.CoupledCluster.calc_MP2"><code>ElemCo.CoupledCluster.calc_MP2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_MP2(EC::ECInfo, addsingles=true)</code></pre><p>Calculate closed-shell MP2 energy and amplitudes.    The amplitudes are stored in <code>T_vvoo</code> file.   If <code>addsingles</code>: singles are also calculated and stored in <code>T_vo</code> file.   Return EMp2 <code>OutDict</code> with keys (<code>E</code>, <code>ESS</code>, <code>EOS</code>, <code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L780-L788">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_UMP2" href="#ElemCo.CoupledCluster.calc_UMP2"><code>ElemCo.CoupledCluster.calc_UMP2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_UMP2(EC::ECInfo, addsingles=true)</code></pre><p>Calculate unrestricted MP2 energy and amplitudes.    The amplitudes are stored in <code>T_vvoo</code>, <code>T_VVOO</code>, and <code>T_vVoO</code> files.   If <code>addsingles</code>: singles are also calculated and stored in <code>T_vo</code> and <code>T_VO</code> files.   Return EMp2 <code>OutDict</code> with keys (<code>E</code>, <code>ESS</code>, <code>EOS</code>, <code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L803-L811">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_UMP2_energy" href="#ElemCo.CoupledCluster.calc_UMP2_energy"><code>ElemCo.CoupledCluster.calc_UMP2_energy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_UMP2_energy(EC::ECInfo, addsingles=true)</code></pre><p>Calculate open-shell MP2 energy from precalculated amplitudes.    If <code>addsingles</code>: singles energy is also calculated.   Return EMp2 <code>OutDict</code> with keys (<code>E</code>, <code>ESS</code>, <code>EOS</code>, <code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L832-L839">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_cc-Tuple{ElemCo.ECInfos.ECInfo, ElemCo.ECMethods.ECMethod}" href="#ElemCo.CoupledCluster.calc_cc-Tuple{ElemCo.ECInfos.ECInfo, ElemCo.ECMethods.ECMethod}"><code>ElemCo.CoupledCluster.calc_cc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_cc(EC::ECInfo, method::ECMethod)</code></pre><p>Calculate coupled cluster amplitudes.</p><p>Exact specification of the method is given by <code>method</code>.   Returns energies <code>::OutDict</code> with the following keys:</p><ul><li><code>&quot;E&quot;</code> - correlation energy</li><li><code>&quot;ESS&quot;</code> - same-spin component</li><li><code>&quot;EOS&quot;</code> - opposite-spin component</li><li><code>&quot;EO&quot;</code> - open-shell component (defined as <span>$E_{αα} - E_{ββ}$</span>)</li><li><code>&quot;EIAS&quot;</code> - internal-active singles (for 2D methods)</li><li><code>&quot;EW&quot;</code> - singlet/triplet energy contribution (for 2D methods)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L1990-L2003">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_lm_cc-Tuple{ElemCo.ECInfos.ECInfo, ElemCo.ECMethods.ECMethod}" href="#ElemCo.CoupledCluster.calc_lm_cc-Tuple{ElemCo.ECInfos.ECInfo, ElemCo.ECMethods.ECMethod}"><code>ElemCo.CoupledCluster.calc_lm_cc</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_lm_cc(EC::ECInfo, method::ECMethod)</code></pre><p>Calculate coupled cluster Lagrange multipliers.</p><p>Exact specification of the method is given by <code>method</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L1113-L1119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_pertT-Tuple{ElemCo.ECInfos.ECInfo, ElemCo.ECMethods.ECMethod}" href="#ElemCo.CoupledCluster.calc_pertT-Tuple{ElemCo.ECInfos.ECInfo, ElemCo.ECMethods.ECMethod}"><code>ElemCo.CoupledCluster.calc_pertT</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_pertT(EC::ECInfo, method::ECMethod; save_t3=false)</code></pre><p>Calculate (T) correction for [Λ][U]CCSD(T)</p><p>Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.    If <code>save_t3</code> is true, the T3 amplitudes are saved in <code>T_vvvooo</code> file (only for closed-shell).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L3-L10">source</a></section></article><h2 id="Internal-functions"><a class="docs-heading-anchor" href="#Internal-functions">Internal functions</a><a id="Internal-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Internal-functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.add_to_singles_and_doubles_residuals-Tuple{Any, Any, Any}" href="#ElemCo.CoupledCluster.add_to_singles_and_doubles_residuals-Tuple{Any, Any, Any}"><code>ElemCo.CoupledCluster.add_to_singles_and_doubles_residuals</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">add_to_singles_and_doubles_residuals(EC, R1, R2)</code></pre><p>Add contributions from triples to singles and doubles residuals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L2268-L2272">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_3ext_times_T2" href="#ElemCo.CoupledCluster.calc_3ext_times_T2"><code>ElemCo.CoupledCluster.calc_3ext_times_T2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_3ext_times_T2(EC::ECInfo, T2::AbstractArray, o1::Char=&#39;o&#39;, v1::Char=&#39;v&#39;, o2::Char=&#39;o&#39;, v2::Char=&#39;v&#39;)</code></pre><p>Calculate <span>$\hat v_{mb}^{cd} T^{ij}_{cd}$</span> intermediate    required in <a href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>calc_ccsd_vector_times_Jacobian</code></a>    and store as <code>vT_ovoo[m,b,i,j]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L941-L947">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_3ext_times_T2-Tuple{ElemCo.ECInfos.ECInfo, AbstractArray, AbstractArray, AbstractArray}" href="#ElemCo.CoupledCluster.calc_3ext_times_T2-Tuple{ElemCo.ECInfos.ECInfo, AbstractArray, AbstractArray, AbstractArray}"><code>ElemCo.CoupledCluster.calc_3ext_times_T2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_3ext_times_T2(EC::ECInfo, T2a::AbstractArray, T2b::AbstractArray, T2ab::AbstractArray)</code></pre><p>Calculate <span>$\hat v_{mb}^{cd} T^{ij}_{cd}$</span> intermediates    required in <a href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>calc_ccsd_vector_times_Jacobian</code></a>    for αα, ββ, and αβ amplitudes    and store as <code>vT_ovoo[m,b,i,j]</code>, <code>vT_OVOO[M,B,I,J]</code>,    <code>vT_oVoO[m,B,i,J]</code> and <code>vT_OvOo[M,b,I,j]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L954-L962">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_4idx_T3T3_XY-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}" href="#ElemCo.CoupledCluster.calc_4idx_T3T3_XY-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}"><code>ElemCo.CoupledCluster.calc_4idx_T3T3_XY</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_4idx_T3T3_XY(EC::ECInfo, T2, UvoX, ϵX)</code></pre><p>Calculate <span>$D^{ij}_{ab} = T^i_{aXY} T^j_{bXY}$</span> using half-decomposed imaginary-shifted perturbative triple amplitudes    <span>$T^i_{aXY}$</span> from <code>T2</code> (and <code>UvoX</code>)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L2387-L2392">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_D2" href="#ElemCo.CoupledCluster.calc_D2"><code>ElemCo.CoupledCluster.calc_D2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_D2(EC::ECInfo, T1, T2, scalepp=false)</code></pre><p>Calculate <span>$D^{ij}_{pq} = T^{ij}_{cd} + T^i_c T^j_d +δ_{ik} T^j_d + T^i_c δ_{jl} + δ_{ik} δ_{jl}$</span>.   Return as <code>D[pqij]</code> </p><p>If <code>scalepp</code>: <code>D[ppij]</code> elements are scaled by 0.5 (for triangular summation).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L854-L862">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_D2-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Symbol}" href="#ElemCo.CoupledCluster.calc_D2-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Symbol}"><code>ElemCo.CoupledCluster.calc_D2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_D2(EC::ECInfo, T1, T2, spin::Symbol)</code></pre><p>Calculate <span>$^{σσ}D^{ij}_{pq} = T^{ij}_{cd} + P_{ij}(T^i_c T^j_d +δ_{ik} T^j_d + T^i_c δ_{jl} + δ_{ik} δ_{jl})$</span>   with <span>$P_{ij} X_{ij} = X_{ij} - X_{ji}$</span>.   Return as <code>D[pqij]</code> </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L890-L897">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_D2ab" href="#ElemCo.CoupledCluster.calc_D2ab"><code>ElemCo.CoupledCluster.calc_D2ab</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_D2ab(EC::ECInfo, T1a, T1b, T2ab, scalepp=false)</code></pre><p>Calculate <span>$^{αβ}D^{ij}_{pq} = T^{ij}_{cd} + T^i_c T^j_d +δ_{ik} T^j_d + T^i_c δ_{jl} + δ_{ik} δ_{jl}$</span>   Return as <code>D[pqij]</code> </p><p>If <code>scalepp</code>: <code>D[ppij]</code> elements are scaled by 0.5 (for triangular summation)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L927-L935">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}" href="#ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}"><code>ElemCo.CoupledCluster.calc_cc_resid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_cc_resid(EC::ECInfo, T1, T2, T3; dc=false, tworef=false, fixref=false)</code></pre><p>Calculate CCSDT or DC-CCSDT residual.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L1616-L1620">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}" href="#ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>ElemCo.CoupledCluster.calc_cc_resid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_cc_resid(EC::ECInfo, T1, T2; dc=false, tworef=false, fixref=false)</code></pre><p>Calculate CCSD or DCSD closed-shell residual.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L963-L967">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 5}}" href="#ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 5}}"><code>ElemCo.CoupledCluster.calc_cc_resid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_cc_resid(EC::ECInfo, T1a, T1b, T2a, T2b, T2ab; dc=false, tworef=false, fixref=false)</code></pre><p>Calculate UCCSD or UDCSD residual.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L1112-L1116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 9}}" href="#ElemCo.CoupledCluster.calc_cc_resid-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 9}}"><code>ElemCo.CoupledCluster.calc_cc_resid</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_cc_resid(EC::ECInfo, T1a, T1b, T2a, T2b, T2ab, T3aaa, T3bbb, T3abb, T3aab; dc=false)</code></pre><p>Calculate UCCSDT or UDC-CCSDT residual.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L1551-L1555">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}" href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ccsd_vector_times_Jacobian(EC::ECInfo, U1, U2; dc=false)</code></pre><p>Calculate the vector times the Jacobian for the closed-shell CCSD or DCSD equations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L3-L8">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 5}}" href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 5}}"><code>ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ccsd_vector_times_Jacobian(EC::ECInfo, U1a, U1b, U2a, U2b, U2ab; dc=false)</code></pre><p>Calculate the vector times the Jacobian for the unresticted CCSD or DCSD equations.</p><p>Return R1a, R1b, R2a, R2b, R2ab</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L238-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian4ab-Tuple{ElemCo.ECInfos.ECInfo, Matrix{Float64}, Matrix{Float64}, Array{Float64, 4}, Array{Float64}, Array{Float64}, Any, Any}" href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian4ab-Tuple{ElemCo.ECInfos.ECInfo, Matrix{Float64}, Matrix{Float64}, Array{Float64, 4}, Array{Float64}, Array{Float64}, Any, Any}"><code>ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian4ab</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ccsd_vector_times_Jacobian4ab(EC::ECInfo, U1a, U1b, U2a, U2b, U2ab, D1a, D1b; dc=false)</code></pre><p>Calculate the left vector times the CCSD/DCSD Jacobian for αβ component.  Additionally, remaining contributions to the singles residual are calculated.</p><p>Return ΔR1a, ΔR1b, R2ab</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L501-L508">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian4spin-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 7}}" href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian4spin-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 7}}"><code>ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian4spin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ccsd_vector_times_Jacobian4spin(EC::ECInfo, U1a, U1b, U2a, U2b, U2ab, D1, dD1, dD1os, spin; dc=false)</code></pre><p>Calculate the vector times the CCSD/DCSD Jacobian for the given <code>spin</code> (same-spin residual for doubles). The singles residual is missing some terms which are added in <code>calc_ccsd_vector_times_Jacobian4ab</code>.</p><p>Return R1 and R2 </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L271-L279">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ccsdt" href="#ElemCo.CoupledCluster.calc_ccsdt"><code>ElemCo.CoupledCluster.calc_ccsdt</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_ccsdt(EC::ECInfo, useT3=false, cc3=false)</code></pre><p>Calculate decomposed closed-shell DC-CCSDT amplitudes.</p><p>If <code>useT3</code>: (T) amplitudes from a preceding calculations will be used as starting guess.   If cc3: calculate CC3 amplitudes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L2190-L2198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_correlation_norm-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}" href="#ElemCo.CoupledCluster.calc_correlation_norm-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>ElemCo.CoupledCluster.calc_correlation_norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_correlation_norm(EC::ECInfo, U1, U2)</code></pre><p>Calculate the norm of the correlation part of the CCSD or DCSD equations   using Lagrange multipliers and amplitudes.</p><p>Return <span>$⟨Λ|Ψ⟩ = ⟨Λ_1|T_1⟩ + ⟨Λ_2|T_2+\frac{1}{2}T_1 T_1⟩$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L1057-L1064">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_correlation_norm-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 5}}" href="#ElemCo.CoupledCluster.calc_correlation_norm-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 5}}"><code>ElemCo.CoupledCluster.calc_correlation_norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_correlation_norm(EC::ECInfo, U1a, U1b, U2a, U2b, U2ab)</code></pre><p>Calculate the norm of the correlation part of the UCCSD or UDCSD equations   using Lagrange multipliers and amplitudes.</p><p>Return <span>$⟨Λ|Ψ⟩ = ⟨Λ_1|T_1⟩ + ⟨Λ_2|T_2+\frac{1}{2}T_1 T_1⟩$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L1079-L1086">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_dU2" href="#ElemCo.CoupledCluster.calc_dU2"><code>ElemCo.CoupledCluster.calc_dU2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_dU2(EC::ECInfo, T1, T12, U2, o1=&#39;o&#39;, v1=&#39;v&#39;, o2=&#39;o&#39;, v2=&#39;v&#39;)</code></pre><p>Calculate the &quot;dressed&quot; <span>$Λ_2$</span> for CCSD/DCSD.</p><p><code>T12</code> is the T1 amplitude for the second electron of <code>U2</code> (=<code>T1</code> for closed-shell and same-spin <code>U2</code>).  Return <code>dU2[p,q,m,n]</code>=<span>$Λ_{mn}^{ab}δ_a^p δ_b^q - Λ_{mn}^{ab}T^i_a δ_i^p δ_b^q - Λ_{mn}^{ab}δ_a^p T^j_b δ_j^q + Λ_{mn}^{ab}T^i_a T^j_b δ_i^p δ_j^q$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L214-L221">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_doubles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}" href="#ElemCo.CoupledCluster.calc_doubles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}"><code>ElemCo.CoupledCluster.calc_doubles_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_doubles_energy(EC::ECInfo, T2a, T2b, T2ab)</code></pre><p>Calculate energy for αα (T2a), ββ (T2b) and αβ (T2ab) doubles amplitudes.   Returns total energy, SS, OS and Openshell contributions   as <code>OutDict</code> with keys (<code>E</code>,<code>ESS</code>,<code>EOS</code>,<code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L168-L174">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_doubles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.calc_doubles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.calc_doubles_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_doubles_energy(EC::ECInfo, T2)</code></pre><p>Calculate coupled-cluster closed-shell doubles energy.   Returns total energy, SS, OS and Openshell (0.0) contributions   as <code>OutDict</code> with keys (<code>E</code>,<code>ESS</code>,<code>EOS</code>,<code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L149-L155">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_dressed_ints-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Vararg{Char, 4}}" href="#ElemCo.CoupledCluster.calc_dressed_ints-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Vararg{Char, 4}}"><code>ElemCo.CoupledCluster.calc_dressed_ints</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_dressed_ints(EC::ECInfo, T1, T12, o1::Char, v1::Char, o2::Char, v2::Char;
          calc_d_vvvv=EC.options.cc.calc_d_vvvv, calc_d_vvvo=EC.options.cc.calc_d_vvvo,
          calc_d_vovv=EC.options.cc.calc_d_vovv, calc_d_vvoo=EC.options.cc.calc_d_vvoo)</code></pre><p>Dress integrals with singles amplitudes. </p><p>The singles and orbspaces for first and second electron are <code>T1</code>, <code>o1</code>, <code>v1</code> and <code>T12</code>, <code>o2</code>, <code>v2</code>, respectively.   The integrals from EC.fd are used and dressed integrals are stored as <code>d_????</code>.   <span>$\hat v_{ab}^{cd}$</span>, <span>$\hat v_{ab}^{ci}$</span>, <span>$\hat v_{ak}^{cd}$</span> and <span>$\hat v_{ab}^{ij}$</span> are only    calculated if requested in <code>EC.options.cc</code> or using keyword-arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L279-L291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_dressed_ints-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.calc_dressed_ints-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.calc_dressed_ints</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_dressed_ints(EC::ECInfo, T1;
          calc_d_vvvv=EC.options.cc.calc_d_vvvv, calc_d_vvvo=EC.options.cc.calc_d_vvvo,
          calc_d_vovv=EC.options.cc.calc_d_vovv, calc_d_vvoo=EC.options.cc.calc_d_vvoo)</code></pre><p>Dress integrals with singles.</p><p><span>$\hat v_{ab}^{cd}$</span>, <span>$\hat v_{ab}^{ci}$</span>, <span>$\hat v_{ak}^{cd}$</span> and <span>$\hat v_{ab}^{ij}$</span> are only    calculated if requested in <code>EC.options.cc</code> or using keyword-arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L691-L700">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_focklike_vT2-Tuple{ElemCo.ECInfos.ECInfo, AbstractArray, AbstractArray, AbstractArray}" href="#ElemCo.CoupledCluster.calc_focklike_vT2-Tuple{ElemCo.ECInfos.ECInfo, AbstractArray, AbstractArray, AbstractArray}"><code>ElemCo.CoupledCluster.calc_focklike_vT2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_focklike_vT2(EC::ECInfo, T2a::AbstractArray, T2b::AbstractArray, T2ab::AbstractArray)</code></pre><p>Calculate the fock-like intermediates <span>$v_{kl}^{cd} T^{il}_{cd}$</span> and <code>v_{kl}^{cd} T^{kl}_{ad}</code>    required in <a href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>calc_ccsd_vector_times_Jacobian</code></a>    for αα/ββ, and αβ amplitudes.   Store as <code>vT_oo[ki]</code>, <code>vT_vv[ac]</code>, <code>vT_OO[ki]</code> and <code>vT_VV[ac]</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L973-L980">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_hylleraas-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 10}}" href="#ElemCo.CoupledCluster.calc_hylleraas-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 10}}"><code>ElemCo.CoupledCluster.calc_hylleraas</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_hylleraas(EC::ECInfo, T1a, T1b, T2a, T2b, T2ab, R1a, R1b, R2a, R2b, R2ab)</code></pre><p>Calculate singles and doubles Hylleraas energy.   Returns total energy, SS, OS and Openshell contributions   as OutDict with keys (<code>E</code>,<code>ESS</code>,<code>EOS</code>,<code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L255-L261">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_hylleraas-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 4}}" href="#ElemCo.CoupledCluster.calc_hylleraas-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 4}}"><code>ElemCo.CoupledCluster.calc_hylleraas</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_hylleraas(EC::ECInfo, T1, T2, R1, R2)</code></pre><p>Calculate closed-shell singles and doubles Hylleraas energy.   Returns total energy, SS, OS and Openshell (0.0) contributions   as <code>OutDict</code> with keys (<code>E</code>,<code>ESS</code>,<code>EOS</code>,<code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L187-L193">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_hylleraas4spincase-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 10}}" href="#ElemCo.CoupledCluster.calc_hylleraas4spincase-Tuple{ElemCo.ECInfos.ECInfo, Vararg{Any, 10}}"><code>ElemCo.CoupledCluster.calc_hylleraas4spincase</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_hylleraas4spincase(EC::ECInfo, o1, v1, o2, v2, T1, T1OS, T2, R1, R2, fov)</code></pre><p>Calculate singles and doubles Hylleraas energy for one spin case.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L225-L229">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_pertT_closed_shell-Tuple{ElemCo.ECInfos.ECInfo}" href="#ElemCo.CoupledCluster.calc_pertT_closed_shell-Tuple{ElemCo.ECInfos.ECInfo}"><code>ElemCo.CoupledCluster.calc_pertT_closed_shell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_pertT_closed_shell(EC::ECInfo; save_t3=false)</code></pre><p>Calculate (T) correction for closed-shell CCSD.</p><p>Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L32-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_pertT_mixedspin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any, Any, Symbol}" href="#ElemCo.CoupledCluster.calc_pertT_mixedspin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any, Any, Symbol}"><code>ElemCo.CoupledCluster.calc_pertT_mixedspin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_pertT_mixedspin(EC::ECInfo, T1, T2, T1os, T2mix, spin::Symbol)</code></pre><p>Calculate mixed-spin (T) correction for UCCSD(T) (i.e., ααβ or ββα).</p><p><code>spin</code> ∈ (:α,:β)   <code>T1</code> and <code>T2</code> are same-<code>spin</code> amplitudes, <code>T1os</code> are opposite-<code>spin</code> amplitudes,   and <code>T2mix</code> are mixed-spin amplitudes with the <em>second</em> electron being <code>spin</code>,   i.e., Tβα for <code>spin == :α</code> and Tαβ for <code>spin == :β</code>.   Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L432-L442">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_pertT_samespin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Symbol}" href="#ElemCo.CoupledCluster.calc_pertT_samespin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Symbol}"><code>ElemCo.CoupledCluster.calc_pertT_samespin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_pertT_samespin(EC::ECInfo, T1, T2, spin::Symbol)</code></pre><p>Calculate same-spin (T) correction for UCCSD(T) (i.e., ααα or βββ).   <code>spin</code> ∈ (:α,:β)</p><p>Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L343-L350">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_pertT_unrestricted-Tuple{ElemCo.ECInfos.ECInfo}" href="#ElemCo.CoupledCluster.calc_pertT_unrestricted-Tuple{ElemCo.ECInfos.ECInfo}"><code>ElemCo.CoupledCluster.calc_pertT_unrestricted</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_pertT_unrestricted(EC::ECInfo)</code></pre><p>Calculate (T) correction for UCCSD.</p><p>Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L282-L288">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_rings_vT2-Tuple{ElemCo.ECInfos.ECInfo, AbstractArray, AbstractArray, AbstractArray}" href="#ElemCo.CoupledCluster.calc_rings_vT2-Tuple{ElemCo.ECInfos.ECInfo, AbstractArray, AbstractArray, AbstractArray}"><code>ElemCo.CoupledCluster.calc_rings_vT2</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_rings_vT2(EC::ECInfo, T2a::AbstractArray, T2b::AbstractArray, T2ab::AbstractArray; dc=false)</code></pre><p>Calculate the ring intermediates required in <a href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>calc_ccsd_vector_times_Jacobian</code></a>   <span>$\hat y_{am}^{ie} = \hat v_{am}^{ie} - \hat v_{am}^{ei} + 2x_{am}^{ie} + v_{mL}^{eD} T^{iL}_{aD}$</span>   and   <span>$\hat y_{Bn}^{Jf} = \hat v_{nB}^{fJ} + 2x_{Bn}^{Jf} + v_{nL}^{fD} T^{LJ}_{DB}$</span>   and the spin-flip version of them,   with    <span>$2x_{am}^{ie} = T^{il}_{ad} (v_{lm}^{de} \red{- v_{ml}^{de}})$</span>   and   <span>$2x_{Am}^{Ie} = T^{Il}_{Ad} (v_{lm}^{de} \red{- v_{ml}^{de}})$</span></p><p>The intermediates are stored as <code>vT_voov[amie]</code>, <code>vT_VOOV[AMIE]</code>, <code>vT_VoOv[BnJf]</code>, <code>vT_vOoV[bNjF]</code>,</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L999-L1013">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_singles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}" href="#ElemCo.CoupledCluster.calc_singles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>ElemCo.CoupledCluster.calc_singles_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_singles_energy(EC::ECInfo, T1a, T1b; fock_only=false)</code></pre><p>Calculate energy for α (T1a) and β (T1b) singles amplitudes.   Returns total energy, SS, OS and Openshell contributions   as <code>OutDict</code> with keys (<code>E</code>,<code>ESS</code>,<code>EOS</code>,<code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L115-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_singles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.calc_singles_energy-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.calc_singles_energy</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_singles_energy(EC::ECInfo, T1; fock_only=false)</code></pre><p>Calculate coupled-cluster closed-shell singles energy.   Returns total energy, SS, OS and Openshell (0.0) contributions   as <code>OutDict</code> with keys (<code>E</code>,<code>ESS</code>,<code>EOS</code>,<code>EO</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L89-L95">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_triples_decomposition-Tuple{ElemCo.ECInfos.ECInfo}" href="#ElemCo.CoupledCluster.calc_triples_decomposition-Tuple{ElemCo.ECInfos.ECInfo}"><code>ElemCo.CoupledCluster.calc_triples_decomposition</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_triples_decomposition(EC::ECInfo)</code></pre><p>Decompose <span>$T^{ijk}_{abc}$</span> as <span>$U^{iX}_a U^{jY}_b U^{kZ}_c T_{XYZ}$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L2340-L2344">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_triples_decomposition_without_triples-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.calc_triples_decomposition_without_triples-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.calc_triples_decomposition_without_triples</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_triples_decomposition_without_triples(EC::ECInfo, T2)</code></pre><p>Decompose <span>$T^{ijk}_{abc}$</span> as <span>$U^{iX}_a U^{jY}_b U^{kZ}_c T_{XYZ}$</span>    without explicit calculation of <span>$T^{ijk}_{abc}$</span>.</p><p>Compute perturbative <span>$T^i_{aXY}$</span> and decompose <span>$D^{ij}_{ab} = (T^i_{aXY} T^j_{bXY})$</span> to get <span>$U^{iX}_a$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L2310-L2317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_triples_residuals" href="#ElemCo.CoupledCluster.calc_triples_residuals"><code>ElemCo.CoupledCluster.calc_triples_residuals</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">calc_triples_residuals(EC::ECInfo, T1, T2, cc3 = false)</code></pre><p>Calculate decomposed triples DC-CCSDT or CC3 residuals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L2462-L2466">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_vT2_intermediates-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}" href="#ElemCo.CoupledCluster.calc_vT2_intermediates-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any}"><code>ElemCo.CoupledCluster.calc_vT2_intermediates</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_vT2_intermediates(EC::ECInfo, T2a, T2b, T2ab; dc=false)</code></pre><p>Calculate intermediates required in unrestricted <a href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>calc_ccsd_vector_times_Jacobian</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L926-L930">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_vT2_intermediates-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.calc_vT2_intermediates-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.calc_vT2_intermediates</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_vT2_intermediates(EC::ECInfo, T2; dc=false)</code></pre><p>Calculate intermediates required in closed-shell <a href="#ElemCo.CoupledCluster.calc_ccsd_vector_times_Jacobian-Tuple{ElemCo.ECInfos.ECInfo, Any, Any}"><code>calc_ccsd_vector_times_Jacobian</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_lagrange.jl#L915-L919">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ΛpertT_closed_shell-Tuple{ElemCo.ECInfos.ECInfo}" href="#ElemCo.CoupledCluster.calc_ΛpertT_closed_shell-Tuple{ElemCo.ECInfos.ECInfo}"><code>ElemCo.CoupledCluster.calc_ΛpertT_closed_shell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ΛpertT_closed_shell(EC::ECInfo)</code></pre><p>Calculate (T) correction for closed-shell ΛCCSD(T).</p><p>The amplitudes are stored in <code>T_vvoo</code> file,    and the Lagrangian multipliers are stored in <code>U_vvoo</code> file.   Return ( <code>&quot;ET3&quot;</code>=(T) energy, <code>&quot;ET3b&quot;</code>=[T] energy) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L146-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ΛpertT_mixedspin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any, Any, Any, Any, Symbol}" href="#ElemCo.CoupledCluster.calc_ΛpertT_mixedspin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any, Any, Any, Any, Symbol}"><code>ElemCo.CoupledCluster.calc_ΛpertT_mixedspin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ΛpertT_mixedspin(EC::ECInfo, T2, T2mix, U1, U2, U1os, U2mix, spin::Symbol)</code></pre><p>Calculate mixed-spin (T) correction for ΛUCCSD(T) (i.e., ααβ or ββα).</p><p><code>spin</code> ∈ (:α,:β)   <code>U1</code> and <code>U2</code>/<code>T2</code> are same-<code>spin</code> Lagrange multipliers/amplitudes,   <code>U1os</code> are opposite-<code>spin</code> Lagrange multipliers,   and <code>U2mix</code>/<code>T2mix</code> are mixed-spin Lagrange multipliers/amplitudes    with the <em>second</em> electron being <code>spin</code>,   i.e., Tβα for <code>spin == :α</code> and Tαβ for <code>spin == :β</code>.   Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L690-L702">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ΛpertT_samespin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any, Symbol}" href="#ElemCo.CoupledCluster.calc_ΛpertT_samespin-Tuple{ElemCo.ECInfos.ECInfo, Any, Any, Any, Symbol}"><code>ElemCo.CoupledCluster.calc_ΛpertT_samespin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ΛpertT_samespin(EC::ECInfo, T2, U1, U2, spin::Symbol)</code></pre><p>Calculate same-spin (T) correction for ΛUCCSD(T) (i.e., ααα or βββ).   <code>spin</code> ∈ (:α,:β)</p><p>Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L570-L577">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.calc_ΛpertT_unrestricted-Tuple{ElemCo.ECInfos.ECInfo}" href="#ElemCo.CoupledCluster.calc_ΛpertT_unrestricted-Tuple{ElemCo.ECInfos.ECInfo}"><code>ElemCo.CoupledCluster.calc_ΛpertT_unrestricted</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">calc_ΛpertT_unrestricted(EC::ECInfo)</code></pre><p>Calculate (T) correction for ΛUCCSD(T).</p><p>Return ( <code>&quot;ET3&quot;</code>=(T)-energy, <code>&quot;ET3b&quot;</code>=[T]-energy)) <code>OutDict</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_triples.jl#L310-L316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.dress_fock_closedshell-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.dress_fock_closedshell-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.dress_fock_closedshell</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dress_fock_closedshell(EC::ECInfo, T1)</code></pre><p>Dress the fock matrix (closed-shell). The dressed fock matrix is stored as <code>df_mm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L549-L554">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.dress_fock_oppositespin-Tuple{ElemCo.ECInfos.ECInfo}" href="#ElemCo.CoupledCluster.dress_fock_oppositespin-Tuple{ElemCo.ECInfos.ECInfo}"><code>ElemCo.CoupledCluster.dress_fock_oppositespin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dress_fock_oppositespin(EC::ECInfo)</code></pre><p>Add the dressed opposite-spin part to the dressed Fock matrix. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L643-L648">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.dress_fock_samespin-Tuple{ElemCo.ECInfos.ECInfo, Any, Char, Char}" href="#ElemCo.CoupledCluster.dress_fock_samespin-Tuple{ElemCo.ECInfos.ECInfo, Any, Char, Char}"><code>ElemCo.CoupledCluster.dress_fock_samespin</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dress_fock_samespin(EC::ECInfo, T1, o1::Char, v1::Char)</code></pre><p>Dress the fock matrix (same-spin part). </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L592-L597">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.oss_active_orbitals-Tuple{ElemCo.ECInfos.ECInfo}" href="#ElemCo.CoupledCluster.oss_active_orbitals-Tuple{ElemCo.ECInfos.ECInfo}"><code>ElemCo.CoupledCluster.oss_active_orbitals</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">oss_active_orbitals(EC::ECInfo)</code></pre><p>Return the four active orbitals of an (2e,2o) open-shell singlet problem based on a single determinant reference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L1668-L1672">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.pseudo_dressed_ints" href="#ElemCo.CoupledCluster.pseudo_dressed_ints"><code>ElemCo.CoupledCluster.pseudo_dressed_ints</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pseudo_dressed_ints(EC::ECInfo, unrestricted=false;
          calc_d_vvvv=EC.options.cc.calc_d_vvvv, calc_d_vvvo=EC.options.cc.calc_d_vvvo,
          calc_d_vovv=EC.options.cc.calc_d_vovv, calc_d_vvoo=EC.options.cc.calc_d_vvoo)</code></pre><p>Save non-dressed integrals in files instead of dressed integrals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc.jl#L718-L724">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.test_UaiX-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.test_UaiX-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.test_UaiX</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">test_UaiX(EC, UaiX)</code></pre><p>Test UaiX</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_tests.jl#L77-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.test_add_to_singles_and_doubles_residuals-NTuple{4, Any}" href="#ElemCo.CoupledCluster.test_add_to_singles_and_doubles_residuals-NTuple{4, Any}"><code>ElemCo.CoupledCluster.test_add_to_singles_and_doubles_residuals</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">test_add_to_singles_and_doubles_residuals(R1, R2, T1, T2)</code></pre><p>Test R1(T3) and R2(T3)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_tests.jl#L37-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.test_calc_pertT_from_T3-Tuple{ElemCo.ECInfos.ECInfo, Any}" href="#ElemCo.CoupledCluster.test_calc_pertT_from_T3-Tuple{ElemCo.ECInfos.ECInfo, Any}"><code>ElemCo.CoupledCluster.test_calc_pertT_from_T3</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">test_calc_pertT_from_T3(EC, T3)</code></pre><p>Test [T]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_tests.jl#L49-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElemCo.CoupledCluster.test_dressed_ints-Tuple{Any, Any}" href="#ElemCo.CoupledCluster.test_dressed_ints-Tuple{Any, Any}"><code>ElemCo.CoupledCluster.test_dressed_ints</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">test_dressed_ints(EC, T1)</code></pre><p>Compare 3-idx dressed integrals to 4-idx dressed integrals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/fkfest/ElemCo.jl/blob/7eb4aa527056012840df601a34c22cf14b2c5385/src/cc/cc_tests.jl#L2-L6">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Kats2013"><a class="tag is-link" href="#citeref-Kats2013">Kats2013</a>D. Kats, and F.R. Manby, Sparse tensor framework for implementation of general local correlation methods, J. Chem. Phys. 138 (2013) 144101. doi:10.1063/1.4798940.</li><li class="footnote" id="footnote-Hampel1992"><a class="tag is-link" href="#citeref-Hampel1992">Hampel1992</a>C. Hampel, K.A. Peterson, and H.-J. Werner, A comparison of the efficiency and accuracy of the quadratic configuration interaction (QCISD), coupled cluster (CCSD), and Brueckner coupled cluster (BCCD) methods, Chem. Phys. Lett. 190 (1992) 1. doi:10.1016/0009-2614(92)86093-W.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../bohf/">« Bi-orthogonal Hartree-Fock</a><a class="docs-footer-nextpage" href="../ccdriver/">Driver for conventional coupled-cluster methods »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Tuesday 9 July 2024 09:08">Tuesday 9 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
